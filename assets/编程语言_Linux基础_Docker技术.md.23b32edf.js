import{_ as s,o as a,c as n,Q as e}from"./chunks/framework.1b72a0e7.js";const h=JSON.parse('{"title":"二、Docker 技术","description":"","frontmatter":{},"headers":[],"relativePath":"编程语言/Linux基础/Docker技术.md","lastUpdated":1700010054000}'),l={name:"编程语言/Linux基础/Docker技术.md"},o=e(`<h1 id="二、docker-技术" tabindex="-1">二、Docker 技术 <a class="header-anchor" href="#二、docker-技术" aria-label="Permalink to &quot;二、Docker 技术&quot;">​</a></h1><div class="tip custom-block"><p class="custom-block-title">TIP</p><p><code>镜像</code>：相当于 python 里面类的概念，是静态的，不能直接使用<br><code>容器</code>：是通过镜像创建的，相当于实例的概念，是动态的，可以访问的<br><code>仓库</code>：存放镜像的地方 <code>docker宿主机</code>：你的 docker 安装在哪一个机器，那个机器就是宿主机</p></div><h2 id="一、-centos-下安装-docker" tabindex="-1">一、 CentOS 下安装 Docker <a class="header-anchor" href="#一、-centos-下安装-docker" aria-label="Permalink to &quot;一、 CentOS 下安装 Docker&quot;">​</a></h2><h3 id="_1-卸载老版本" tabindex="-1">1. 卸载老版本 <a class="header-anchor" href="#_1-卸载老版本" aria-label="Permalink to &quot;1. 卸载老版本&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">remove</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">docker-client</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">docker-client-latest</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">docker-common</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker-latest</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">docker-latest-logrotate</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">docker-logrotate</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker-engine</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="_2-安装-docker-插件" tabindex="-1">2. 安装 Docker 插件 <a class="header-anchor" href="#_2-安装-docker-插件" aria-label="Permalink to &quot;2. 安装 Docker 插件&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-y</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">yum-utils</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">device-mapper-persistent-data</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">lvm2</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_3-添加-yum-国内源" tabindex="-1">3. 添加 yum 国内源 <a class="header-anchor" href="#_3-添加-yum-国内源" aria-label="Permalink to &quot;3. 添加 yum 国内源&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 阿里云镜像仓库</span></span>
<span class="line"><span style="color:#FFCB6B;">yum-config-manager</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">--add-repo</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 官网源镜像仓库(不推荐)</span></span>
<span class="line"><span style="color:#FFCB6B;">yum-config-manager</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--add-repo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">https://download.docker.com/linux/centos/docker-ce.repo</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_4-安装-docker" tabindex="-1">4. 安装 Docker <a class="header-anchor" href="#_4-安装-docker" aria-label="Permalink to &quot;4. 安装 Docker&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-y</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker-ce</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker-ce-cli</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">containerd.io</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_5-设置开机启动、开始运行" tabindex="-1">5. 设置开机启动、开始运行 <a class="header-anchor" href="#_5-设置开机启动、开始运行" aria-label="Permalink to &quot;5. 设置开机启动、开始运行&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">enable</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker</span></span>
<span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">start</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_6-查看-docker-运行状态" tabindex="-1">6. 查看 docker 运行状态 <a class="header-anchor" href="#_6-查看-docker-运行状态" aria-label="Permalink to &quot;6. 查看 docker 运行状态&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">status</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_7-关闭防火墙" tabindex="-1">7. 关闭防火墙 <a class="header-anchor" href="#_7-关闭防火墙" aria-label="Permalink to &quot;7. 关闭防火墙&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">stop</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">disable</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="二、创建容器" tabindex="-1">二、创建容器 <a class="header-anchor" href="#二、创建容器" aria-label="Permalink to &quot;二、创建容器&quot;">​</a></h2><h3 id="_1-设置镜像加速" tabindex="-1">1. 设置镜像加速 <a class="header-anchor" href="#_1-设置镜像加速" aria-label="Permalink to &quot;1. 设置镜像加速&quot;">​</a></h3><h4 id="_1-在指定目录创建文件-如已存在请忽略此步" tabindex="-1">1. 在指定目录创建文件（如已存在请忽略此步） <a class="header-anchor" href="#_1-在指定目录创建文件-如已存在请忽略此步" aria-label="Permalink to &quot;1. 在指定目录创建文件（如已存在请忽略此步）&quot;">​</a></h4><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">touch</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/etc/docker/daemon.json</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">vi</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/etc/docker/daemon.json</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_2-修改文件内容" tabindex="-1">2. 修改文件内容 <a class="header-anchor" href="#_2-修改文件内容" aria-label="Permalink to &quot;2. 修改文件内容&quot;">​</a></h4><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">registry-mirrors</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">https://elk58vq5.mirror.aliyuncs.com</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_2-重启-docker-服务" tabindex="-1">2. 重启 Docker 服务 <a class="header-anchor" href="#_2-重启-docker-服务" aria-label="Permalink to &quot;2. 重启 Docker 服务&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">restart</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_3-拉取-最新-镜像" tabindex="-1">3. 拉取 最新 镜像 <a class="header-anchor" href="#_3-拉取-最新-镜像" aria-label="Permalink to &quot;3. 拉取 最新 镜像&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pull</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">tomcat</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ol><li>拉取最新镜像 ： <code>docker pull tomcat</code></li><li>拉取指定镜像 ： <code>docker pull tomcat:7</code></li><li>删除镜像 ： <code>docker rmi 镜像id</code></li></ol><p><img src="https://img.pupper.cn/img/20220725181600.png" alt=""></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 查看 拉取的 镜像</span></span>
<span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">images</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="https://img.pupper.cn/img/20220725181625.png" alt=""></p><h3 id="_4-创建并运行容器" tabindex="-1">4. 创建并运行容器 <a class="header-anchor" href="#_4-创建并运行容器" aria-label="Permalink to &quot;4. 创建并运行容器&quot;">​</a></h3><blockquote><p>创建容器语法格式: docker run -id --name=容器名称 -p 宿主机端口:容器端口 -v 宿主机目录:容器目录 镜像名称</p></blockquote><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">run</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-id</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--name=myTomcat</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">-p</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">8080</span><span style="color:#C3E88D;">:</span><span style="color:#F78C6C;">8080</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">-v</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/usr/local/tomcat/webapps:/usr/local/tomcat/webapps</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C3E88D;">tomcat</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>docker run 后面的参数:</strong></p><ul><li><code>-i</code> ：运行容器</li><li><code>-t</code> ： 容器启动后，进入命令行</li><li><code>-d</code> ： 守护进程 --- 后台运行</li><li><code>-p</code> ： 端口映射 <ul><li><code>-p 宿主机端口:容器端口</code></li></ul></li><li><code>-v</code> ： 目录映射 --- 挂载 <ul><li><code>-v 宿主机目录:容器目录</code></li></ul></li></ul><h3 id="_5-创建容器关联其他容器" tabindex="-1">5. 创建容器关联其他容器 <a class="header-anchor" href="#_5-创建容器关联其他容器" aria-label="Permalink to &quot;5. 创建容器关联其他容器&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">run</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-id</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--name=tomcat2</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-p</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">8080</span><span style="color:#C3E88D;">:</span><span style="color:#F78C6C;">8080</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--link</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">mysql</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--link</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">redis</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--link</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">rabbitmq</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="三、容器-图形化管理工具-portainer" tabindex="-1">三、容器 图形化管理工具（ Portainer ） <a class="header-anchor" href="#三、容器-图形化管理工具-portainer" aria-label="Permalink to &quot;三、容器 图形化管理工具（ Portainer ）&quot;">​</a></h2><h3 id="_1-官方网站" tabindex="-1">1.官方网站 <a class="header-anchor" href="#_1-官方网站" aria-label="Permalink to &quot;1.官方网站&quot;">​</a></h3><p><a href="https://hub.docker.com/r/6053537/portainer-ce" target="_blank" rel="noreferrer">docker hub portainer-ce 中文汉化版</a></p><h3 id="_2-选择喜欢的-portainer-风格镜像-下载" tabindex="-1">2.选择喜欢的 portainer 风格镜像，下载 <a class="header-anchor" href="#_2-选择喜欢的-portainer-风格镜像-下载" aria-label="Permalink to &quot;2.选择喜欢的 portainer 风格镜像，下载&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pull</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">hub-mirror.c.163.com/</span><span style="color:#F78C6C;">6053537</span><span style="color:#C3E88D;">/portainer-ce</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_3-启动-dockerui-容器" tabindex="-1">3.启动 dockerui 容器 <a class="header-anchor" href="#_3-启动-dockerui-容器" aria-label="Permalink to &quot;3.启动 dockerui 容器&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">run</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-d</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--restart=always</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--name=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">portainer</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-p</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">9000</span><span style="color:#C3E88D;">:</span><span style="color:#F78C6C;">9000</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-v</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/var/run/docker.sock:/var/run/docker.sock</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-v</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">portainer_data:/data</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">6053537</span><span style="color:#C3E88D;">/portainer-ce</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_4-访问" tabindex="-1">4.访问 <a class="header-anchor" href="#_4-访问" aria-label="Permalink to &quot;4.访问&quot;">​</a></h3><p>浏览器访问 <a href="http://xn--6qq288bu9cl3tcvs" target="_blank" rel="noreferrer">http://你虚拟机的</a> ip:9000, 设置一个密码即可，点击创建用户 密码要 8 位以上</p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>如果无法访问,需要查看端口是否开放(云服务器需要去官网开放)</p></div><h2 id="四、其他操作命令" tabindex="-1">四、其他操作命令 <a class="header-anchor" href="#四、其他操作命令" aria-label="Permalink to &quot;四、其他操作命令&quot;">​</a></h2><table><thead><tr><th>命令</th><th>说明</th></tr></thead><tbody><tr><td><code>systemctl restart docker</code></td><td>重启 docker</td></tr><tr><td><code>systemctl stop docker</code></td><td>停止 docker</td></tr><tr><td><code>docker exec -it 容器名称 /bin/bash</code></td><td>进入容器</td></tr><tr><td><code> exit</code></td><td>退出容器</td></tr><tr><td><code>docker images</code></td><td>查看本地镜像</td></tr><tr><td><code>docker ps</code></td><td>查看运行的容器</td></tr><tr><td><code>docker ps -a</code></td><td>查看所有容器</td></tr><tr><td><code>docker start 容器名/容器 id</code></td><td>运行容器</td></tr><tr><td><code>docker stop 容器名/容器 id</code></td><td>停止容器</td></tr><tr><td><code>docker stop $(docker ps -a -q}</code></td><td>停止所有运行的容器</td></tr><tr><td><code>docker rm 容器名/容器 id</code></td><td>删除没有运行的容器</td></tr><tr><td><code>docker rm -f 容器名/容器 id</code></td><td>删除运行的运行容器</td></tr><tr><td><code>docker start 容器名/容器 id</code></td><td>运行容器</td></tr><tr><td><code>docker rm $(docker ps -a -q}</code></td><td>删除所有未运行的容器</td></tr><tr><td><code>docker cp 文件名 容器名:/</code></td><td>向容器中拷贝文件</td></tr><tr><td><code>docker cp 容器名:/文件名 /root</code></td><td>向宿主机拷贝文件</td></tr><tr><td><code>docker images</code></td><td>查看本地镜像</td></tr><tr><td><code>docker images</code></td><td>查看本地镜像</td></tr><tr><td><code>docker images</code></td><td>查看本地镜像</td></tr></tbody></table><h2 id="五、-查看日志-docker-logs-命令" tabindex="-1">五、 查看日志 （ docker logs 命令） <a class="header-anchor" href="#五、-查看日志-docker-logs-命令" aria-label="Permalink to &quot;五、 查看日志 （ docker logs 命令）&quot;">​</a></h2><p><code>docker logs [options] 容器名称或ID</code> 获取容器日志</p><table><thead><tr><th>名字</th><th>默 认 值</th><th>描述</th></tr></thead><tbody><tr><td>–details</td><td>显示提供给日志的额外细节</td><td></td></tr><tr><td>–follow 或-f</td><td>按日志输出</td><td></td></tr><tr><td>–since</td><td>从某个时间开始显示，例如 2013- 01-02T13:23:37</td><td></td></tr><tr><td>–tail</td><td>all</td><td>从日志末尾多少行开始显示</td></tr><tr><td>– timestamps 或-t</td><td>显示时间戳</td><td></td></tr><tr><td>–until</td><td>打印某个时间以前的日志，例如 2013-01-02T13:23:37</td><td></td></tr></tbody></table><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 通过docker logs命令可以查看容器的日志。</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">logs</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-f</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--tail</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">a4dac74d48f7</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 查看指定时间后的日志，只显示最后100行：</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">logs</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-f</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-t</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--since=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">2018-02-08</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--tail=100</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">CONTAINER_ID</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 查看某时间段日志</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">logs</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-t</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--since=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">2018-02-08T13:23:37</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--until</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">2018-02-09T12:23:37</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">CONTAINER_ID</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="六、docker-旧版卸载" tabindex="-1">六、docker 旧版卸载 <a class="header-anchor" href="#六、docker-旧版卸载" aria-label="Permalink to &quot;六、docker 旧版卸载&quot;">​</a></h2><h3 id="_1-卸载它们以及相关的依赖项" tabindex="-1">1. 卸载它们以及相关的依赖项 <a class="header-anchor" href="#_1-卸载它们以及相关的依赖项" aria-label="Permalink to &quot;1. 卸载它们以及相关的依赖项&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">sudo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">remove</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker</span><span style="color:#A6ACCD;"> \\d</span><span style="color:#C3E88D;">ocker-client</span><span style="color:#A6ACCD;"> \\d</span><span style="color:#C3E88D;">ocker-client-latest</span><span style="color:#A6ACCD;"> \\d</span><span style="color:#C3E88D;">ocker-common</span><span style="color:#A6ACCD;"> \\d</span><span style="color:#C3E88D;">ocker-latest</span><span style="color:#A6ACCD;"> \\d</span><span style="color:#C3E88D;">ocker-latest-logrotate</span><span style="color:#A6ACCD;"> \\d</span><span style="color:#C3E88D;">ocker-logrotate</span><span style="color:#A6ACCD;"> \\d</span><span style="color:#C3E88D;">ocker-engine</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_2-安装-docker-engine-community" tabindex="-1">2. 安装 Docker Engine-Community <a class="header-anchor" href="#_2-安装-docker-engine-community" aria-label="Permalink to &quot;2. 安装 Docker Engine-Community&quot;">​</a></h3><p>在新主机上首次安装 Docker Engine-Community 之前，需要设置 Docker 仓库。</p><p>之后，您可以从仓库安装和更新 Docker。</p><h4 id="_1-设置仓库" tabindex="-1">1. 设置仓库 <a class="header-anchor" href="#_1-设置仓库" aria-label="Permalink to &quot;1. 设置仓库&quot;">​</a></h4><p>安装所需的软件包。</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">sudo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-y</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">yum-utils</span><span style="color:#A6ACCD;"> \\d</span><span style="color:#C3E88D;">evice-mapper-persistent-data</span><span style="color:#A6ACCD;"> \\l</span><span style="color:#C3E88D;">vm2</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>使用以下命令来设置稳定的仓库。阿里云</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">sudo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">yum-config-manager</span><span style="color:#A6ACCD;"> \\-</span><span style="color:#C3E88D;">-add-repo</span><span style="color:#A6ACCD;"> \\ </span><span style="color:#C3E88D;">http://mirrors.aliyun.com/dockerce/linux/centos/docker-ce.repo</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h4 id="_2-安装-docker-engine-community-1" tabindex="-1">2. 安装 Docker Engine-Community <a class="header-anchor" href="#_2-安装-docker-engine-community-1" aria-label="Permalink to &quot;2. 安装 Docker Engine-Community&quot;">​</a></h4><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">sudo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker-ce</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker-ce-clicontainerd.io</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>一直输入 y 回车即可</p><h3 id="_3-启动-docker" tabindex="-1">3. 启动 docker <a class="header-anchor" href="#_3-启动-docker" aria-label="Permalink to &quot;3. 启动 docker&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">sudo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">start</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="七-p、-修改-容器的-映射端口及挂载目录" tabindex="-1">七 p、 修改 容器的 映射端口及挂载目录 <a class="header-anchor" href="#七-p、-修改-容器的-映射端口及挂载目录" aria-label="Permalink to &quot;七 p、 修改 容器的 映射端口及挂载目录&quot;">​</a></h2><h3 id="_1-停止容器" tabindex="-1">1. 停止容器 <a class="header-anchor" href="#_1-停止容器" aria-label="Permalink to &quot;1. 停止容器&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">stop</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">容器id或名称</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_2-停止-docker-服务" tabindex="-1">2. 停止 docker 服务 <a class="header-anchor" href="#_2-停止-docker-服务" aria-label="Permalink to &quot;2. 停止 docker 服务&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">stop</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_3-修改-hostconfig-json-文件" tabindex="-1">3. 修改 hostconfig.json 文件 <a class="header-anchor" href="#_3-修改-hostconfig-json-文件" aria-label="Permalink to &quot;3. 修改 hostconfig.json 文件&quot;">​</a></h3><blockquote><p><code>config,v2.json</code> 中如果也记录了端口，需要一并修改</p></blockquote><p>文件目录：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#82AAFF;">cd</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/var/lib/docker/containers/容器id</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">vi</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">hostconfig.json</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><img src="https://img.pupper.cn/img/20220725181827.png" alt=""></p><h4 id="_1-修改-映射端口" tabindex="-1">1. 修改 映射端口 <a class="header-anchor" href="#_1-修改-映射端口" aria-label="Permalink to &quot;1. 修改 映射端口&quot;">​</a></h4><p>没有端口映射时：<code>“PortBindings”:{} </code></p><p>增加一个端口映射：</p><blockquote><p>前面的 “3306” 为 容器端口， 后面的 “3307” 为宿主机端口</p><p>如果修改现有端口映射，则可以直接修改</p></blockquote><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">“PortBindings”:</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">“3306/tcp”</span><span style="color:#89DDFF;">:[{</span><span style="color:#A6ACCD;">“HostIp”</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;">&quot;&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">“HostPort”</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">“</span><span style="color:#F78C6C;">3307</span><span style="color:#A6ACCD;">”</span><span style="color:#89DDFF;">}]}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h4 id="_2-修改-挂载目录" tabindex="-1">2. 修改 挂载目录 <a class="header-anchor" href="#_2-修改-挂载目录" aria-label="Permalink to &quot;2. 修改 挂载目录&quot;">​</a></h4><blockquote><p>前面的地址为 宿主机挂载目录，后面的地址为 容器目录地址</p></blockquote><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Binds</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">:</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/var/run/docker.sock:/var/run/docker.sock</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_4-启动-docker-服务" tabindex="-1">4. 启动 docker 服务 <a class="header-anchor" href="#_4-启动-docker-服务" aria-label="Permalink to &quot;4. 启动 docker 服务&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">systemstl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">start</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_5-启动-容器" tabindex="-1">5. 启动 容器 <a class="header-anchor" href="#_5-启动-容器" aria-label="Permalink to &quot;5. 启动 容器&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">start</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">容器id</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_6-查看修改后的结果" tabindex="-1">6. 查看修改后的结果 <a class="header-anchor" href="#_6-查看修改后的结果" aria-label="Permalink to &quot;6. 查看修改后的结果&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ps</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-a</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_7-查看修改后的挂载目录" tabindex="-1">7. 查看修改后的挂载目录 <a class="header-anchor" href="#_7-查看修改后的挂载目录" aria-label="Permalink to &quot;7. 查看修改后的挂载目录&quot;">​</a></h3><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">docker inspect container_id | grep Mounts -A 20</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="九、-同步时间" tabindex="-1">九、 同步时间 <a class="header-anchor" href="#九、-同步时间" aria-label="Permalink to &quot;九、 同步时间&quot;">​</a></h2><h3 id="_1-查看宿主机时间" tabindex="-1">1.查看宿主机时间 <a class="header-anchor" href="#_1-查看宿主机时间" aria-label="Permalink to &quot;1.查看宿主机时间&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">date</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_2-安装-ntp" tabindex="-1">2. 安装 ntp <a class="header-anchor" href="#_2-安装-ntp" aria-label="Permalink to &quot;2. 安装 ntp&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ntp</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_3-同步时间" tabindex="-1">3. 同步时间 <a class="header-anchor" href="#_3-同步时间" aria-label="Permalink to &quot;3. 同步时间&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">cp</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/etc/localtime</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">容器id或名称:/etc/localtime</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>报错：</p><p><img src="https://img.pupper.cn/img/20220725181909.png" alt=""></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">cp</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/usr/share/zoneinfo/Asia/Shanghai</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">容器ID或名称:/etc/localtime</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_4-重启-容器" tabindex="-1">4. 重启 容器 <a class="header-anchor" href="#_4-重启-容器" aria-label="Permalink to &quot;4. 重启 容器&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">restart</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">容器id或名称</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><blockquote><p><strong>注意事项：</strong></p><ul><li>可能网络会断开，请重新 reboot 下 linux</li><li>虚拟机的 ip 可能会改变</li></ul></blockquote>`,111),p=[o];function r(t,c,i,d,C,y){return a(),n("div",null,p)}const m=s(l,[["render",r]]);export{h as __pageData,m as default};
