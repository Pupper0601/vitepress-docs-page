import{_ as s,o as a,c as n,Q as e}from"./chunks/framework.1b72a0e7.js";const y=JSON.parse('{"title":"十、10.Docker 技术","description":"","frontmatter":{},"headers":[],"relativePath":"软件测试/接口自动化/Docker技术.md","lastUpdated":1700010054000}'),l={name:"软件测试/接口自动化/Docker技术.md"},p=e(`<h1 id="十、10-docker-技术" tabindex="-1">十、10.Docker 技术 <a class="header-anchor" href="#十、10-docker-技术" aria-label="Permalink to &quot;十、10.Docker 技术&quot;">​</a></h1><h2 id="一、-docker-技术简介" tabindex="-1">一、 Docker 技术简介 <a class="header-anchor" href="#一、-docker-技术简介" aria-label="Permalink to &quot;一、 Docker 技术简介&quot;">​</a></h2><p><img src="https://img.pupper.cn/img/20220725181025.png" alt=""></p><h3 id="_1-docker-组成" tabindex="-1">1. docker 组成 <a class="header-anchor" href="#_1-docker-组成" aria-label="Permalink to &quot;1. docker 组成&quot;">​</a></h3><ul><li><code>镜像</code>：相当于 python 里面类的概念，是静态的，不能直接使用</li><li><code>容器</code>：是通过镜像创建的，相当于实例的概念，是动态的，可以访问的</li><li><code>仓库</code>：存放镜像的地方</li><li><code>docker宿主机</code>：你的 docker 安装在哪一个机器，那个机器就是宿主机</li></ul><h3 id="_2-docker-应用场景" tabindex="-1">2. docker 应用场景 <a class="header-anchor" href="#_2-docker-应用场景" aria-label="Permalink to &quot;2. docker 应用场景&quot;">​</a></h3><ul><li>web 应用的自动化打包和发布</li><li>自动化测试和持续集成、发布</li><li>在服务型环境中部署和调整数据库或其他的后台应用</li><li>使用 docker 可以实现开发人员的开发环境、测试人员的测试环境、运维人员的生产环境的一致性</li></ul><h2 id="二、-centos-下安装-docker" tabindex="-1">二、 CentOS 下安装 Docker <a class="header-anchor" href="#二、-centos-下安装-docker" aria-label="Permalink to &quot;二、 CentOS 下安装 Docker&quot;">​</a></h2><h3 id="_1-版本检查" tabindex="-1">1. 版本检查 <a class="header-anchor" href="#_1-版本检查" aria-label="Permalink to &quot;1. 版本检查&quot;">​</a></h3><ul><li>CentOS 7 以上版本</li><li>操作系统 centos-extras 库必须启用。默认情况下，此库是启用的，但是如果已禁用，则必须重新启动它</li><li><strong>Docker 要求 CentOS 内核版本高于 3.10</strong></li></ul><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 查看系统版本</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">uname</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-r</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><img src="https://img.pupper.cn/img/20220725181050.png" alt=""></p><h3 id="_2-安装-docker" tabindex="-1">2. 安装 Docker <a class="header-anchor" href="#_2-安装-docker" aria-label="Permalink to &quot;2. 安装 Docker&quot;">​</a></h3><h4 id="_1-安装需要的软件包" tabindex="-1">1. 安装需要的软件包 <a class="header-anchor" href="#_1-安装需要的软件包" aria-label="Permalink to &quot;1. 安装需要的软件包&quot;">​</a></h4><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">yum install </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">y yum</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">utils device</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">mapper</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">persistent</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">data lvm2</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="https://img.pupper.cn/img/20220725181111.png" alt=""></p><ul><li><code>yum-util</code> 是 yum 仓库管理扩展工具包，即它提供了 <code>yum-config-manager</code> 功能</li><li>另外两个是 <code>devicemapper</code> 驱动依赖的</li></ul><h4 id="_2-添加-yum-源" tabindex="-1">2. 添加 yum 源 <a class="header-anchor" href="#_2-添加-yum-源" aria-label="Permalink to &quot;2. 添加 yum 源&quot;">​</a></h4><div class="language-sh line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 阿里云镜像仓库</span></span>
<span class="line"><span style="color:#FFCB6B;">yum-config-manager</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--add-repo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 官网源镜像仓库</span></span>
<span class="line"><span style="color:#FFCB6B;">yum-config-manager</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--add-repo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">https://download.docker.com/linux/centos/docker-ce.repo</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><img src="https://img.pupper.cn/img/20220725181152.png" alt=""></p><ul><li>利用 <code>yum-config-manager</code> 添加 yum 仓库</li><li>查看仓库 <code>ll /etc/yum.repos.d</code></li></ul><p><img src="https://img.pupper.cn/img/20220725181213.png" alt=""></p><h4 id="_3-更新-yum-缓存" tabindex="-1">3.更新 yum 缓存 <a class="header-anchor" href="#_3-更新-yum-缓存" aria-label="Permalink to &quot;3.更新 yum 缓存&quot;">​</a></h4><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">makecache</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">fast</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="https://img.pupper.cn/img/20220725181240.png" alt=""></p><h4 id="_4-查看仓库中-docker-的版本" tabindex="-1">4.查看仓库中 docker 的版本 <a class="header-anchor" href="#_4-查看仓库中-docker-的版本" aria-label="Permalink to &quot;4.查看仓库中 docker 的版本&quot;">​</a></h4><p>选择对应的版本安装，列出并排序存储库中可用的版本。按版本号（从高到低）对结果进行排序</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">list</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker-ce</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--showduplicates</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">sort</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-r</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="https://img.pupper.cn/img/20220725181308.png" alt=""></p><h4 id="_5-安装-docker" tabindex="-1">5. 安装 docker <a class="header-anchor" href="#_5-安装-docker" aria-label="Permalink to &quot;5. 安装 docker&quot;">​</a></h4><ol><li>安装最新版本</li></ol><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-y</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker-ce</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ol start="2"><li>安装指定版本</li></ol><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker-ce-版本号</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docer-ce-17.12.1.ce</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_6-验证是否安装成功" tabindex="-1">6. 验证是否安装成功 <a class="header-anchor" href="#_6-验证是否安装成功" aria-label="Permalink to &quot;6. 验证是否安装成功&quot;">​</a></h4><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">version</span></span>
<span class="line"><span style="color:#FFCB6B;">或者</span></span>
<span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-v</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">有client和service两部分标识docker安装并启动成功</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><img src="https://img.pupper.cn/img/20210722180548.png" alt="image-20210722180548342"></p><h4 id="_7-启动-docker" tabindex="-1">7. 启动 docker <a class="header-anchor" href="#_7-启动-docker" aria-label="Permalink to &quot;7. 启动 docker&quot;">​</a></h4><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">start</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ol><li><p>启动 ： <code>systemctl start docker</code></p></li><li><p>关闭 ： <code>systemctl stop docker</code></p></li><li><p>重启 ： <code>systemctl restart docker </code></p></li></ol><h4 id="_8-开机自动启动" tabindex="-1">8. 开机自动启动 <a class="header-anchor" href="#_8-开机自动启动" aria-label="Permalink to &quot;8. 开机自动启动&quot;">​</a></h4><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">enable</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h4 id="_9-查看-docker-运行状态" tabindex="-1">9. 查看 docker 运行状态 <a class="header-anchor" href="#_9-查看-docker-运行状态" aria-label="Permalink to &quot;9. 查看 docker 运行状态&quot;">​</a></h4><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">status</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="https://img.pupper.cn/img/20220725181348.png" alt=""></p><h4 id="_10-关闭防火墙" tabindex="-1">10. 关闭防火墙 <a class="header-anchor" href="#_10-关闭防火墙" aria-label="Permalink to &quot;10. 关闭防火墙&quot;">​</a></h4><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">stop</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">firewalld</span><span style="color:#A6ACCD;"> 	</span><span style="color:#676E95;font-style:italic;"># 临时关闭</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">stop</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">disable		#</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">永久关闭</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="三、docker-镜像-加速-阿里云" tabindex="-1">三、Docker 镜像 加速（阿里云） <a class="header-anchor" href="#三、docker-镜像-加速-阿里云" aria-label="Permalink to &quot;三、Docker 镜像 加速（阿里云）&quot;">​</a></h2><blockquote><p>默认情况下，docker 下载镜像是从官网下载，下载速度特别特别的慢。</p><p>使用阿里云加速器可以提升获取 Docker 官方镜像的速度 。</p></blockquote><h3 id="_1-阿里云-镜像-加速" tabindex="-1">1. 阿里云 镜像 加速 <a class="header-anchor" href="#_1-阿里云-镜像-加速" aria-label="Permalink to &quot;1. 阿里云 镜像 加速&quot;">​</a></h3><p>每个账号的 镜像 加速 地址都不同</p><p><a href="https://cr.console.aliyun.com/cn-beijing/instances/mirrors" target="_blank" rel="noreferrer">阿里云 --- 容器镜像服务 地址</a> <a href="https://cr.console.aliyun.com/cn-beijing/instances/mirrors" target="_blank" rel="noreferrer">https://cr.console.aliyun.com/cn-beijing/instances/mirrors</a></p><p><img src="https://img.pupper.cn/img/20220725181413.png" alt=""></p><h3 id="_2-在指定目录创建文件-如已存在请忽略此步" tabindex="-1">2. 在指定目录创建文件（如已存在请忽略此步） <a class="header-anchor" href="#_2-在指定目录创建文件-如已存在请忽略此步" aria-label="Permalink to &quot;2. 在指定目录创建文件（如已存在请忽略此步）&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">vi</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/etc/docker/daemon.json</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_3-修改文件内容" tabindex="-1">3. 修改文件内容 <a class="header-anchor" href="#_3-修改文件内容" aria-label="Permalink to &quot;3. 修改文件内容&quot;">​</a></h3><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">registry-mirrors</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">https://elk58vq5.mirror.aliyuncs.com</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><img src="https://img.pupper.cn/img/20220725181434.png" alt=""></p><h3 id="_4-重启-docker-服务" tabindex="-1">4. 重启 Docker 服务 <a class="header-anchor" href="#_4-重启-docker-服务" aria-label="Permalink to &quot;4. 重启 Docker 服务&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">restart</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="四、docker-中安装镜像及操作" tabindex="-1">四、Docker 中安装镜像及操作 <a class="header-anchor" href="#四、docker-中安装镜像及操作" aria-label="Permalink to &quot;四、Docker 中安装镜像及操作&quot;">​</a></h2><h3 id="_1-获取-镜像" tabindex="-1">1. 获取 镜像 <a class="header-anchor" href="#_1-获取-镜像" aria-label="Permalink to &quot;1. 获取 镜像&quot;">​</a></h3><h4 id="_1-查看-本地-镜像" tabindex="-1">1. 查看 本地 镜像 <a class="header-anchor" href="#_1-查看-本地-镜像" aria-label="Permalink to &quot;1. 查看 本地 镜像&quot;">​</a></h4><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">images</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="https://img.pupper.cn/img/20220725181458.png" alt=""></p><h4 id="_2-搜索-镜像" tabindex="-1">2. 搜索 镜像 <a class="header-anchor" href="#_2-搜索-镜像" aria-label="Permalink to &quot;2. 搜索 镜像&quot;">​</a></h4><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">search</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">tomcat</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="https://img.pupper.cn/img/20220725181532.png" alt=""></p><h4 id="_3-拉取-最新-镜像" tabindex="-1">3. 拉取 最新 镜像 <a class="header-anchor" href="#_3-拉取-最新-镜像" aria-label="Permalink to &quot;3. 拉取 最新 镜像&quot;">​</a></h4><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pull</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">tomcat</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ol><li>拉取最新镜像 ： <code>docker pull tomcat</code></li><li>拉取指定镜像 ： <code>docker pull tomcat:7</code></li><li>删除镜像 ： <code>docker rmi 镜像id</code></li></ol><p><img src="https://img.pupper.cn/img/20220725181600.png" alt=""></p><h4 id="_4-查看-拉取的-镜像" tabindex="-1">4. 查看 拉取的 镜像 <a class="header-anchor" href="#_4-查看-拉取的-镜像" aria-label="Permalink to &quot;4. 查看 拉取的 镜像&quot;">​</a></h4><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">images</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="https://img.pupper.cn/img/20220725181625.png" alt=""></p><h3 id="_2-创建-容器" tabindex="-1">2. 创建 容器 <a class="header-anchor" href="#_2-创建-容器" aria-label="Permalink to &quot;2. 创建 容器&quot;">​</a></h3><h4 id="_1-创建容器" tabindex="-1">1. 创建容器 <a class="header-anchor" href="#_1-创建容器" aria-label="Permalink to &quot;1. 创建容器&quot;">​</a></h4><p>根据 tomcat 镜像，创建一个 myTomcat 容器</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--name=myTomcat</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">tomcat</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="https://img.pupper.cn/img/20220725181650.png" alt=""></p><h4 id="_2-查看-容器" tabindex="-1">2. 查看 容器 <a class="header-anchor" href="#_2-查看-容器" aria-label="Permalink to &quot;2. 查看 容器&quot;">​</a></h4><ul><li>查看运行的容器：</li></ul><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ps</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li>查看所有的容器：</li></ul><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ps</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-a</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="https://img.pupper.cn/img/20220725181712.png" alt=""></p><h4 id="_3-运行-容器" tabindex="-1">3. 运行 容器 <a class="header-anchor" href="#_3-运行-容器" aria-label="Permalink to &quot;3. 运行 容器&quot;">​</a></h4><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">start</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">myTomcat</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>start 后面可以跟 容器的<code>id</code>（前 2-3 位） 或者 <code>name</code></p><p><img src="https://img.pupper.cn/img/20220725181737.png" alt=""></p><ul><li><p>停止 容器：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">stop</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">myTomcat</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li><li><p>删除 没有运行的 容器</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">rm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">容器id或者名字</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li><li><p>删除 运行的容器</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">rm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-f</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">容器ID或者名字</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li><li><p>删除所有容器</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 先停止所有的容器</span></span>
<span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">stop</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$(</span><span style="color:#FFCB6B;">docker</span><span style="color:#C3E88D;"> ps -a -q</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 删除</span></span>
<span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">rm</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$(</span><span style="color:#FFCB6B;">docker</span><span style="color:#C3E88D;"> ps -a -q</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li></ul><h3 id="_3-创建-容器的一些-操作" tabindex="-1">3. 创建 容器的一些 操作 <a class="header-anchor" href="#_3-创建-容器的一些-操作" aria-label="Permalink to &quot;3. 创建 容器的一些 操作&quot;">​</a></h3><h4 id="_1-搭建-web-项目" tabindex="-1">1. 搭建 web 项目 <a class="header-anchor" href="#_1-搭建-web-项目" aria-label="Permalink to &quot;1. 搭建 web 项目&quot;">​</a></h4><ol><li>访问端口 你需要访问的是容器内部的端口</li><li><code>war项目文件</code>这么传递给容器里的<code>tomcat</code>里<code>webapps</code>下</li></ol><h4 id="_2-创建-并-启动容器" tabindex="-1">2. 创建 并 启动容器 <a class="header-anchor" href="#_2-创建-并-启动容器" aria-label="Permalink to &quot;2. 创建 并 启动容器&quot;">​</a></h4><p><code>docker run 后面的参数</code> ：</p><ul><li><code>-i</code> ：运行容器</li><li><code>-t</code> ： 容器启动后，进入命令行</li><li><code>-v</code> ： 目录映射 --- 挂载 <ul><li><code>-v 宿主机目录:容器目录</code></li></ul></li><li><code>-d</code> ： 守护进程 --- 后台运行</li><li><code>-p</code> ： 端口映射 <ul><li><code>-p 宿主机端口:容器端口</code></li></ul></li></ul><p><strong>创建容器，并且进入命令行---进入容器</strong></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">run</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-it</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--name=myTomcat</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">tomcat/bin/bash</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h4 id="_3-创建-运行-一个守护的-容器" tabindex="-1">3. 创建 运行 一个守护的 容器 <a class="header-anchor" href="#_3-创建-运行-一个守护的-容器" aria-label="Permalink to &quot;3. 创建 运行 一个守护的 容器&quot;">​</a></h4><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">run</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-id</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--name=myTomcat2</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">tomcat</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h4 id="_4-进入容器" tabindex="-1">4. 进入容器 <a class="header-anchor" href="#_4-进入容器" aria-label="Permalink to &quot;4. 进入容器&quot;">​</a></h4><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">exec</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-it</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">myTomcat2</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/bin/bash</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h4 id="_5-退出容器" tabindex="-1">5. 退出容器 <a class="header-anchor" href="#_5-退出容器" aria-label="Permalink to &quot;5. 退出容器&quot;">​</a></h4><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#82AAFF;">exit</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_4-宿主机-服务器-与-docker-容器的-文件传递" tabindex="-1">4. 宿主机（服务器） 与 docker 容器的 文件传递 <a class="header-anchor" href="#_4-宿主机-服务器-与-docker-容器的-文件传递" aria-label="Permalink to &quot;4. 宿主机（服务器） 与 docker 容器的 文件传递&quot;">​</a></h3><blockquote><p>传递文件时，都需要在 宿主机 中输入命令</p></blockquote><h4 id="_1-宿主机-向-docker-容器-传递文件" tabindex="-1">1. 宿主机 向 docker 容器 传递文件 <a class="header-anchor" href="#_1-宿主机-向-docker-容器-传递文件" aria-label="Permalink to &quot;1. 宿主机 向 docker 容器 传递文件&quot;">​</a></h4><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># docker 拷贝 文件名 容器名称:拷贝路径</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">cp</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">xt.txt</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">myTomcat:/</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_2-docker-容器-向-宿主机-传递文件" tabindex="-1">2. docker 容器 向 宿主机 传递文件 <a class="header-anchor" href="#_2-docker-容器-向-宿主机-传递文件" aria-label="Permalink to &quot;2. docker 容器 向 宿主机 传递文件&quot;">​</a></h4><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># docker 拷贝 容器名称:文件名 拷贝路径</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">cp</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">myTomcat:/文件名</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/root</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_5-访问-tomcat" tabindex="-1">5. 访问 tomcat <a class="header-anchor" href="#_5-访问-tomcat" aria-label="Permalink to &quot;5. 访问 tomcat&quot;">​</a></h3><h4 id="_1-启动并作为守护进程" tabindex="-1">1. 启动并作为守护进程 <a class="header-anchor" href="#_1-启动并作为守护进程" aria-label="Permalink to &quot;1. 启动并作为守护进程&quot;">​</a></h4><blockquote><ul><li><code>-p</code> ： 宿主机的端口:容器里应用的端口 --- 8080</li><li><code>-v</code> ： war 挂载到宿主机 宿主机路径:容器路径（路径会新建）</li></ul></blockquote><p><strong>创建并运行一个名为 myTomcat 的守护容器，端口为 8080，war 挂载到了宿主机的 /usr/local/tomcat/webapps 目录</strong></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">run</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-id</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--name=myTomcat</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-p</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">8080</span><span style="color:#C3E88D;">:</span><span style="color:#F78C6C;">8080</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-v</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/usr/local/tomcat/webapps:/usr/local/tomcat/webapps</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">tomcat</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>把 war 包放到宿主机的 挂载目录里，直接刷新浏览器就可以出现项目的页面</p><h4 id="_2-启动容器时关联其他容器" tabindex="-1">2. 启动容器时关联其他容器 <a class="header-anchor" href="#_2-启动容器时关联其他容器" aria-label="Permalink to &quot;2. 启动容器时关联其他容器&quot;">​</a></h4><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">run</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-id</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--name=tomcat2</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-p</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">8080</span><span style="color:#C3E88D;">:</span><span style="color:#F78C6C;">8080</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--link</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">mysql</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--link</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">redis</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--link</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">rabbitmq</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="五、-查看日志-docker-logs-命令" tabindex="-1">五、 查看日志 （ docker logs 命令） <a class="header-anchor" href="#五、-查看日志-docker-logs-命令" aria-label="Permalink to &quot;五、 查看日志 （ docker logs 命令）&quot;">​</a></h2><p><code>docker logs [options] 容器名称或ID</code> 获取容器日志</p><table><thead><tr><th>名字</th><th>默 认 值</th><th>描述</th></tr></thead><tbody><tr><td>–details</td><td>显示提供给日志的额外细节</td><td></td></tr><tr><td>–follow 或-f</td><td>按日志输出</td><td></td></tr><tr><td>–since</td><td>从某个时间开始显示，例如 2013- 01-02T13:23:37</td><td></td></tr><tr><td>–tail</td><td>all</td><td>从日志末尾多少行开始显示</td></tr><tr><td>– timestamps 或-t</td><td>显示时间戳</td><td></td></tr><tr><td>–until</td><td>打印某个时间以前的日志，例如 2013-01-02T13:23:37</td><td></td></tr></tbody></table><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 通过docker logs命令可以查看容器的日志。</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">logs</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-f</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--tail</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">a4dac74d48f7</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 查看指定时间后的日志，只显示最后100行：</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">logs</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-f</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-t</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--since=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">2018-02-08</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--tail=100</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">CONTAINER_ID</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 查看某时间段日志</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">logs</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-t</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--since=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">2018-02-08T13:23:37</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--until</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">2018-02-09T12:23:37</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">CONTAINER_ID</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="六、容器-图形化管理工具-portainer" tabindex="-1">六、容器 图形化管理工具（ Portainer ） <a class="header-anchor" href="#六、容器-图形化管理工具-portainer" aria-label="Permalink to &quot;六、容器 图形化管理工具（ Portainer ）&quot;">​</a></h2><p>1.查看 portainer 镜像</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">search</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">portainer</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>2.选择喜欢的 portainer 风格镜像，下载</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pull</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">portainer/portainer</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>3.启动 dockerui 容器</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">run</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-id</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--name=portainer</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-p</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">9000</span><span style="color:#C3E88D;">:</span><span style="color:#F78C6C;">9000</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-v</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/var/run/docker.sock:/var/run/docker.sock</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">portainer/portainer</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>4、浏览器访问 <a href="http://xn--6qq288bu9cl3tcvs" target="_blank" rel="noreferrer">http://你虚拟机的</a> ip:9000, 设置一个密码即可，点击创建用户 密码要 8 位以上</p><p>5、我们搭建的是单机版，进入页面直接选择 Local ，点击连接</p><h2 id="七、docker-旧版卸载" tabindex="-1">七、docker 旧版卸载 <a class="header-anchor" href="#七、docker-旧版卸载" aria-label="Permalink to &quot;七、docker 旧版卸载&quot;">​</a></h2><h3 id="_1-卸载它们以及相关的依赖项" tabindex="-1">1. 卸载它们以及相关的依赖项 <a class="header-anchor" href="#_1-卸载它们以及相关的依赖项" aria-label="Permalink to &quot;1. 卸载它们以及相关的依赖项&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">sudo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">remove</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker</span><span style="color:#A6ACCD;"> \\d</span><span style="color:#C3E88D;">ocker-client</span><span style="color:#A6ACCD;"> \\d</span><span style="color:#C3E88D;">ocker-client-latest</span><span style="color:#A6ACCD;"> \\d</span><span style="color:#C3E88D;">ocker-common</span><span style="color:#A6ACCD;"> \\d</span><span style="color:#C3E88D;">ocker-latest</span><span style="color:#A6ACCD;"> \\d</span><span style="color:#C3E88D;">ocker-latest-logrotate</span><span style="color:#A6ACCD;"> \\d</span><span style="color:#C3E88D;">ocker-logrotate</span><span style="color:#A6ACCD;"> \\d</span><span style="color:#C3E88D;">ocker-engine</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_2-安装-docker-engine-community" tabindex="-1">2. 安装 Docker Engine-Community <a class="header-anchor" href="#_2-安装-docker-engine-community" aria-label="Permalink to &quot;2. 安装 Docker Engine-Community&quot;">​</a></h3><p>在新主机上首次安装 Docker Engine-Community 之前，需要设置 Docker 仓库。</p><p>之后，您可以从仓库安装和更新 Docker。</p><h4 id="_1-设置仓库" tabindex="-1">1. 设置仓库 <a class="header-anchor" href="#_1-设置仓库" aria-label="Permalink to &quot;1. 设置仓库&quot;">​</a></h4><p>安装所需的软件包。</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">sudo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-y</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">yum-utils</span><span style="color:#A6ACCD;"> \\d</span><span style="color:#C3E88D;">evice-mapper-persistent-data</span><span style="color:#A6ACCD;"> \\l</span><span style="color:#C3E88D;">vm2</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>使用以下命令来设置稳定的仓库。阿里云</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">sudo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">yum-config-manager</span><span style="color:#A6ACCD;"> \\-</span><span style="color:#C3E88D;">-add-repo</span><span style="color:#A6ACCD;"> \\ </span><span style="color:#C3E88D;">http://mirrors.aliyun.com/dockerce/linux/centos/docker-ce.repo</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h4 id="_2-安装-docker-engine-community-1" tabindex="-1">2. 安装 Docker Engine-Community <a class="header-anchor" href="#_2-安装-docker-engine-community-1" aria-label="Permalink to &quot;2. 安装 Docker Engine-Community&quot;">​</a></h4><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">sudo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker-ce</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker-ce-clicontainerd.io</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>一直输入 y 回车即可</p><h3 id="_3-启动-docker" tabindex="-1">3. 启动 docker <a class="header-anchor" href="#_3-启动-docker" aria-label="Permalink to &quot;3. 启动 docker&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">sudo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">start</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="八、-修改-容器的-映射端口及挂载目录" tabindex="-1">八、 修改 容器的 映射端口及挂载目录 <a class="header-anchor" href="#八、-修改-容器的-映射端口及挂载目录" aria-label="Permalink to &quot;八、 修改 容器的 映射端口及挂载目录&quot;">​</a></h2><h3 id="_1-停止容器" tabindex="-1">1. 停止容器 <a class="header-anchor" href="#_1-停止容器" aria-label="Permalink to &quot;1. 停止容器&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">stop</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">容器id或名称</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_2-停止-docker-服务" tabindex="-1">2. 停止 docker 服务 <a class="header-anchor" href="#_2-停止-docker-服务" aria-label="Permalink to &quot;2. 停止 docker 服务&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">stop</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_3-修改-hostconfig-json-文件" tabindex="-1">3. 修改 hostconfig.json 文件 <a class="header-anchor" href="#_3-修改-hostconfig-json-文件" aria-label="Permalink to &quot;3. 修改 hostconfig.json 文件&quot;">​</a></h3><blockquote><p><code>config,v2.json</code> 中如果也记录了端口，需要一并修改</p></blockquote><p>文件目录：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#82AAFF;">cd</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/var/lib/docker/containers/容器id</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">vi</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">hostconfig.json</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><img src="https://img.pupper.cn/img/20220725181827.png" alt=""></p><h4 id="_1-修改-映射端口" tabindex="-1">1. 修改 映射端口 <a class="header-anchor" href="#_1-修改-映射端口" aria-label="Permalink to &quot;1. 修改 映射端口&quot;">​</a></h4><p>没有端口映射时：<code>“PortBindings”:{} </code></p><p>增加一个端口映射：</p><blockquote><p>前面的 “3306” 为 容器端口， 后面的 “3307” 为宿主机端口</p><p>如果修改现有端口映射，则可以直接修改</p></blockquote><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">“PortBindings”:</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">“3306/tcp”</span><span style="color:#89DDFF;">:[{</span><span style="color:#A6ACCD;">“HostIp”</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;">&quot;&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">“HostPort”</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">“</span><span style="color:#F78C6C;">3307</span><span style="color:#A6ACCD;">”</span><span style="color:#89DDFF;">}]}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h4 id="_2-修改-挂载目录" tabindex="-1">2. 修改 挂载目录 <a class="header-anchor" href="#_2-修改-挂载目录" aria-label="Permalink to &quot;2. 修改 挂载目录&quot;">​</a></h4><blockquote><p>前面的地址为 宿主机挂载目录，后面的地址为 容器目录地址</p></blockquote><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Binds</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">:</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/var/run/docker.sock:/var/run/docker.sock</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_4-启动-docker-服务" tabindex="-1">4. 启动 docker 服务 <a class="header-anchor" href="#_4-启动-docker-服务" aria-label="Permalink to &quot;4. 启动 docker 服务&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">systemstl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">start</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_5-启动-容器" tabindex="-1">5. 启动 容器 <a class="header-anchor" href="#_5-启动-容器" aria-label="Permalink to &quot;5. 启动 容器&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">start</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">容器id</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_6-查看修改后的结果" tabindex="-1">6. 查看修改后的结果 <a class="header-anchor" href="#_6-查看修改后的结果" aria-label="Permalink to &quot;6. 查看修改后的结果&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ps</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-a</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_7-查看修改后的挂载目录" tabindex="-1">7. 查看修改后的挂载目录 <a class="header-anchor" href="#_7-查看修改后的挂载目录" aria-label="Permalink to &quot;7. 查看修改后的挂载目录&quot;">​</a></h3><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">docker inspect container_id | grep Mounts -A 20</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="九、-同步时间" tabindex="-1">九、 同步时间 <a class="header-anchor" href="#九、-同步时间" aria-label="Permalink to &quot;九、 同步时间&quot;">​</a></h2><h3 id="_1-查看宿主机时间" tabindex="-1">1.查看宿主机时间 <a class="header-anchor" href="#_1-查看宿主机时间" aria-label="Permalink to &quot;1.查看宿主机时间&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">date</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_2-安装-ntp" tabindex="-1">2. 安装 ntp <a class="header-anchor" href="#_2-安装-ntp" aria-label="Permalink to &quot;2. 安装 ntp&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ntp</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_3-同步时间" tabindex="-1">3. 同步时间 <a class="header-anchor" href="#_3-同步时间" aria-label="Permalink to &quot;3. 同步时间&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">cp</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/etc/localtime</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">容器id或名称:/etc/localtime</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>报错：</p><p><img src="https://img.pupper.cn/img/20220725181909.png" alt=""></p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">cp</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/usr/share/zoneinfo/Asia/Shanghai</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">容器ID或名称:/etc/localtime</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_4-重启-容器" tabindex="-1">4. 重启 容器 <a class="header-anchor" href="#_4-重启-容器" aria-label="Permalink to &quot;4. 重启 容器&quot;">​</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">restart</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">容器id或名称</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><blockquote><p><strong>注意事项：</strong></p><ul><li>可能网络会断开，请重新 reboot 下 linux</li><li>虚拟机的 ip 可能会改变</li></ul></blockquote>`,189),o=[p];function r(t,c,i,d,C,u){return a(),n("div",null,o)}const m=s(l,[["render",r]]);export{y as __pageData,m as default};
