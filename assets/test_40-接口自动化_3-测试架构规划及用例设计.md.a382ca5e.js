import{_ as s,o as n,c as a,Q as l}from"./chunks/framework.1b72a0e7.js";const C=JSON.parse('{"title":"三、测试架构规划及用例设计","description":"","frontmatter":{},"headers":[],"relativePath":"test/40-接口自动化/3-测试架构规划及用例设计.md","lastUpdated":1699515980000}'),p={name:"test/40-接口自动化/3-测试架构规划及用例设计.md"},o=l(`<h1 id="三、测试架构规划及用例设计" tabindex="-1">三、测试架构规划及用例设计 <a class="header-anchor" href="#三、测试架构规划及用例设计" aria-label="Permalink to &quot;三、测试架构规划及用例设计&quot;">​</a></h1><h2 id="一、-测试架构规划" tabindex="-1">一、 测试架构规划 <a class="header-anchor" href="#一、-测试架构规划" aria-label="Permalink to &quot;一、 测试架构规划&quot;">​</a></h2><h4 id="四文件夹" tabindex="-1">四文件夹： <a class="header-anchor" href="#四文件夹" aria-label="Permalink to &quot;四文件夹：&quot;">​</a></h4><ul><li><code>docs</code> ： 主要用于存放 和项目相关的文件；</li><li><code>logo</code> ： 主要用于存放 项目执行的日志；</li><li><code>report</code> ： 用于存放报告的 原始数据；</li><li><code>data</code> ： 用于存放 测试数据；</li></ul><h4 id="四包文件" tabindex="-1">四包文件 ： <a class="header-anchor" href="#四包文件" aria-label="Permalink to &quot;四包文件 ：&quot;">​</a></h4><ul><li><code>libs</code> ： 用于存放 基本的 代码；</li><li><code>configs</code> ： 用于存放 配置文件；</li><li><code>test_case</code> ： 用于存放 测试用例；</li><li><code>tools</code> ： 用于存放 封装的 工具；</li></ul><h2 id="二、接口测试用例设计" tabindex="-1">二、接口测试用例设计 <a class="header-anchor" href="#二、接口测试用例设计" aria-label="Permalink to &quot;二、接口测试用例设计&quot;">​</a></h2><ul><li>编号</li><li>模块</li><li>接口名称</li><li>优先级</li><li>标题</li><li>URL</li><li>前置条件</li><li>请求方式</li><li>请求头</li><li>请求参数</li><li>预期结果</li><li>响应预期结果</li><li>实际结果</li></ul><h2 id="三、自动化结合-excel-用例执行" tabindex="-1">三、自动化结合 excel 用例执行 <a class="header-anchor" href="#三、自动化结合-excel-用例执行" aria-label="Permalink to &quot;三、自动化结合 excel 用例执行&quot;">​</a></h2><p>配置：</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># configs/confing.py</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">HOST </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">http://121.41.14.39:8082</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>登录：</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># libs/login.py</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> requests</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> hashlib</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> configs</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">config </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> HOST</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">get_md5</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">password</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;"># 1- 实例化加密对象</span></span>
<span class="line"><span style="color:#A6ACCD;">    md5 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> hashlib</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">md5</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;"># 2- 进行加密操作</span></span>
<span class="line"><span style="color:#A6ACCD;">    md5</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">update</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">password</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">encode</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">utf-8</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">))</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;"># 3- 返回加密后的结果</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> md5</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">hexdigest</span><span style="color:#89DDFF;">()</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Login</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;"># 登录类</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">login</span><span style="color:#89DDFF;">(</span><span style="color:#F07178;font-style:italic;">self</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">inData</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">getToken</span><span style="color:#89DDFF;">=False):</span></span>
<span class="line"><span style="color:#A6ACCD;">        url </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&#39;</span><span style="color:#F78C6C;">{</span><span style="color:#A6ACCD;">HOST</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">/account/sLogin&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;font-style:italic;"># 请求体----字典格式编辑</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;font-style:italic;"># 调用加密函数      字典修改值： 字典名【键名】 = 新的值</span></span>
<span class="line"><span style="color:#A6ACCD;">        inData</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">password</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">get_md5</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">inData</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">password</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">])</span></span>
<span class="line"><span style="color:#A6ACCD;">        payload </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> inData  </span><span style="color:#676E95;font-style:italic;"># 可以不写</span></span>
<span class="line"><span style="color:#A6ACCD;">        resp </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> requests</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">post</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">url</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;font-style:italic;">data</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">payload</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> getToken</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;"># 获取token</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> resp</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">json</span><span style="color:#89DDFF;">()[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">data</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">][</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">token</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;"># token值</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> resp</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">json</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;"># 接口的响应数据</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p>读取、写入文件：</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># tools/excelControl.py</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> xlrd  </span><span style="color:#676E95;font-style:italic;"># 要安装的第三库  pip install xlrd</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> json</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">get_excelData</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">sheetName</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">caseName</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">    resList </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;"># 存放结果</span></span>
<span class="line"><span style="color:#A6ACCD;">    excelDir </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">../data/外卖系统接口测试用例-V1.5.xls</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;"># formatting_info=True   保持原表样式</span></span>
<span class="line"><span style="color:#A6ACCD;">    workBook </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> xlrd</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">open_workbook</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">excelDir</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;font-style:italic;">formatting_info</span><span style="color:#89DDFF;">=True)</span></span>
<span class="line"><span style="color:#A6ACCD;">    workSheet </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> workBook</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">sheet_by_name</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">sheetName</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    idx </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;"># excel第0行数据</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#A6ACCD;"> one </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#A6ACCD;"> workSheet</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">col_values</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">):</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;"># 6次</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> caseName </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;"> one</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;"># 运行你需要运行的测试用例</span></span>
<span class="line"><span style="color:#A6ACCD;">            reqBodyData </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> workSheet</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">cell</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">idx</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">9</span><span style="color:#89DDFF;">).</span><span style="color:#F07178;">value</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;"># cell(行号，列号).value</span></span>
<span class="line"><span style="color:#A6ACCD;">            respData </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> workSheet</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">cell</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">idx</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">11</span><span style="color:#89DDFF;">).</span><span style="color:#F07178;">value</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;"># cell(行号，列号).value</span></span>
<span class="line"><span style="color:#A6ACCD;">            resList</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">append</span><span style="color:#89DDFF;">((</span><span style="color:#82AAFF;">json</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">loads</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">reqBodyData</span><span style="color:#89DDFF;">),</span><span style="color:#82AAFF;"> json</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">loads</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">respData</span><span style="color:#89DDFF;">)))</span></span>
<span class="line"><span style="color:#A6ACCD;">        idx </span><span style="color:#89DDFF;">+=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;"># 轮询下一行数据</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> resList</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 新建空的excel  xlwt</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> xlutils</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">copy </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> copy  </span><span style="color:#676E95;font-style:italic;"># 拷贝函数</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">set_excelData</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">sheetIndex</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">    excelDir </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">../data/外卖系统接口测试用例-V1.5.xls</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;"># formatting_info=True   保持原表样式</span></span>
<span class="line"><span style="color:#A6ACCD;">    workBook </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> xlrd</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">open_workbook</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">excelDir</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;font-style:italic;">formatting_info</span><span style="color:#89DDFF;">=True)</span></span>
<span class="line"><span style="color:#A6ACCD;">    workBookNew </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">copy</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">workBook</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    workSheetNew </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> workBookNew</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get_sheet</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">sheetIndex</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;"># 打开复制的excel其中一个表--登录模块</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> workBookNew</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> workSheetNew</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>执行测试用例：</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># test_case/test_login.py</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 1、读取excel数据</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> tools</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">excelControl </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> get_excelData</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> set_excelData</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> lib</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">apiLib</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">login </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> Login</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">workBookNew</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> workSheetNew </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">set_excelData</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;"># 复制出来的表文件对象，子表对象</span></span>
<span class="line"><span style="color:#A6ACCD;">resList </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">get_excelData</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">登录模块</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Login</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#A6ACCD;"> one </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#A6ACCD;"> resList</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;"># [(body1,resp1),(),()]</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">print</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">one</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 2- 把excel读取的数据关联到请求代码里</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#A6ACCD;"> one </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">range</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> len</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">resList</span><span style="color:#89DDFF;">)):</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;"># one---012345</span></span>
<span class="line"><span style="color:#A6ACCD;">    res </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Login</span><span style="color:#89DDFF;">().</span><span style="color:#82AAFF;">login</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">resList</span><span style="color:#89DDFF;">[</span><span style="color:#82AAFF;">one</span><span style="color:#89DDFF;">][</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">])</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;"># 传入对应行的body</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">print</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">res</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;"># 3-实际与预期相对比，结果写入测试结果到excel----做判断--断言</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> res</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">msg</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">==</span><span style="color:#A6ACCD;"> resList</span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">one</span><span style="color:#89DDFF;">][</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">][</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">msg</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]:</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;font-style:italic;"># 写入成功！</span></span>
<span class="line"><span style="color:#A6ACCD;">        workSheetNew</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">write</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">one </span><span style="color:#89DDFF;">+</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">12</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">pass</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;"># workSheetNew.write(行号，列号，值)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;font-style:italic;"># 写入没有成功！</span></span>
<span class="line"><span style="color:#A6ACCD;">        workSheetNew</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">write</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">one </span><span style="color:#89DDFF;">+</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">12</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">fail</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;"># workSheetNew.write(行号，列号，值)</span></span>
<span class="line"><span style="color:#A6ACCD;">workBookNew</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">save</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./res.xls</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="四、-扩展操作-增加脚本模板" tabindex="-1">四、 扩展操作 --- 增加脚本模板 <a class="header-anchor" href="#四、-扩展操作-增加脚本模板" aria-label="Permalink to &quot;四、 扩展操作 --- 增加脚本模板&quot;">​</a></h2><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">-*-coding : UTF-8 -*-</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@File     : \${NAME}.py</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@Time     : \${DATE} \${TIME}</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@Author   : Pupper</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@Email    : Pupper.cheng@gmail.com</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">@Software : \${PRODUCT_NAME}</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div>`,19),e=[o];function t(c,r,y,D,i,F){return n(),a("div",null,e)}const b=s(p,[["render",t]]);export{C as __pageData,b as default};
